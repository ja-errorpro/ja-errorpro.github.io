{{/* layouts/shortcodes/link-grid.html */}}
<div class="link-grid">
  {{ $lines := split .Inner "\n" }} {{ range $lines }} {{ $line := . }} {{/*
  Match standard markdown links: - [Title](URL) or just [Title](URL) */}} {{
  $linkMatches := findRE `\[([^\]]+)\]\(([^\)]+)\)` $line }} {{ if gt (len
  $linkMatches) 0 }} {{ range $linkMatches }} {{/* Extract raw content */}} {{
  $title := replaceRE `^\[([^\]]+)\].*` "$1" . }} {{/* Extract URL content
  inside parentheses */}} {{ $urlContent := replaceRE `^.*\]\(([^\)]+)\)$` "$1"
  . }} {{/* Defaults */}} {{ $url := $urlContent }} {{ $image := "" }} {{/*
  Check for image URL in title attribute format: URL "Image" */}} {{ if findRE
  `\s+"[^"]+"$` $urlContent }} {{/* Extract URL (everything before the space
  quote) */}} {{ $url = replaceRE `^(\S+)\s+.*$` "$1" $urlContent }} {{/*
  Extract Image (inside the quotes at the end) */}} {{ $image = replaceRE
  `^.*\s+"([^"]+)"$` "$1" $urlContent }} {{ $url = replace $url "\"" "" }} {{
  end }} {{/* Clean URL just in case */}} {{ $url = trim $url " " }} {{ $domain
  := replaceRE `^https?://([^/]+).*` "$1" $url }}

  <a href="{{ $url }}" target="_blank" class="grid-item">
    <div class="icon">
      {{ if ne $image "" }}
      <img src="{{ $image }}" alt="{{ $title }}" />
      {{ else }}
      <img
        src="https://www.google.com/s2/favicons?domain={{ $domain }}&sz=64"
        alt="{{ $title }}"
      />
      {{ end }}
    </div>
    <div class="title">{{ $title }}</div>
  </a>
  {{ end }} {{ end }} {{ end }}
</div>

<style>
  .link-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 20px;
    margin-top: 20px;
    margin-bottom: 20px;
  }

  .link-grid .grid-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 15px;
    transition: all 0.2s ease-in-out;
    background-color: var(--card-bg, #fff); /* Fallback */
    color: var(--text-color, inherit);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  }

  .link-grid .grid-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border-color: #bbb;
  }

  .link-grid .icon {
    width: 48px;
    height: 48px;
    margin-bottom: 10px;
    display: flex; /* Center image inside container */
    align-items: center;
    justify-content: center;
  }

  .link-grid .icon img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: 4px;
  }

  .link-grid .title {
    font-size: 0.9rem;
    font-weight: 500;
    text-align: center;
    word-break: break-word;
    line-height: 1.2;
  }

  /* Dark mode adjustments if applicable - assuming common class names or media query */
  @media (prefers-color-scheme: dark) {
    .link-grid .grid-item {
      background-color: #2d2d2d;
      border-color: #444;
      color: #ddd;
    }
    .link-grid .grid-item:hover {
      background-color: #383838;
      border-color: #666;
    }
  }
</style>
