<!doctype html><html lang=zh-Hant-TW><head><link rel=preload href=/%20lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/%20lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/%20lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/%20lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>算法筆記-數論 | ErrorPro</title><link rel=canonical href=https://ja-errorpro.codes/posts/1/algo-number-theory/><meta name=description content="我覺得現在在看這句話的人超電"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://ja-errorpro.codes/posts/1/algo-number-theory/"><meta property="og:site_name" content="ErrorPro"><meta property="og:title" content="算法筆記-數論"><meta property="og:description" content="算法筆記目錄 什麼是數論 數學的分支，專門研究整數的性質。
模運算 同餘 $a \equiv b \pmod n $ 表示 $n\ |\ (a-b)$ ( $n$ 整除 $a-b$ )，稱 $a$ 與 $b$ 模 $n$ 同餘。
比如
7 除以 3 餘 1
10 除以 3 餘 1
則可以說 $7 \equiv 10 \pmod 3$
證明: 對於 $a \equiv b \pmod k $
令 $a = ks + r,\ b = kt + r$
兩式相減得 $a-b = k(s-t)$
證明結束
加乘法性質 如果 $a \equiv b \pmod n $, $c \equiv d \pmod n $"><meta property="og:locale" content="zh_Hant_TW"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:tag" content="Algorithms"><meta name=twitter:card content="summary"><meta name=twitter:title content="算法筆記-數論"><meta name=twitter:description content="算法筆記目錄 什麼是數論 數學的分支，專門研究整數的性質。
模運算 同餘 $a \equiv b \pmod n $ 表示 $n\ |\ (a-b)$ ( $n$ 整除 $a-b$ )，稱 $a$ 與 $b$ 模 $n$ 同餘。
比如
7 除以 3 餘 1
10 除以 3 餘 1
則可以說 $7 \equiv 10 \pmod 3$
證明: 對於 $a \equiv b \pmod k $
令 $a = ks + r,\ b = kt + r$
兩式相減得 $a-b = k(s-t)$
證明結束
加乘法性質 如果 $a \equiv b \pmod n $, $c \equiv d \pmod n $"><link rel=stylesheet href=https://ja-errorpro.codes/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><link rel=stylesheet href=https://ja-errorpro.codes/css/highlight.css><link rel=stylesheet href=https://ja-errorpro.codes/css/style-dark.css><link rel=stylesheet href=https://ja-errorpro.codes/css/search.css><link rel=stylesheet href=https://ja-errorpro.codes/css/cursor.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://ja-errorpro.codes/images/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-LP899FV1TS"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LP899FV1TS")</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>主頁</a></li><li><a href=/posts>廢文區</a></li><li><a href=/resources>資源</a></li><li><a href=/tags>標籤</a></li><li><a href=/comment>留言區</a></li><li><a href=/about>關於本人</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://ja-errorpro.codes/posts/1/algo-runtime/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://ja-errorpro.codes/posts/1/algo-sorting/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&text=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&is_video=false&description=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&body=Check out this article: https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&name=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&description=%3cul%3e%0a%3cli%3e%3ca%20href%3d%22%2fposts%2falgo-index%2f%22%3e%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98%e7%9b%ae%e9%8c%84%3c%2fa%3e%3c%2fli%3e%0a%3c%2ful%3e%0a%3ch2%20id%3d%22%e4%bb%80%e9%ba%bc%e6%98%af%e6%95%b8%e8%ab%96%22%3e%e4%bb%80%e9%ba%bc%e6%98%af%e6%95%b8%e8%ab%96%3c%2fh2%3e%0a%3cp%3e%e6%95%b8%e5%ad%b8%e7%9a%84%e5%88%86%e6%94%af%ef%bc%8c%e5%b0%88%e9%96%80%e7%a0%94%e7%a9%b6%e6%95%b4%e6%95%b8%e7%9a%84%e6%80%a7%e8%b3%aa%e3%80%82%3c%2fp%3e%0a%3chr%3e%0a%3ch2%20id%3d%22%e6%a8%a1%e9%81%8b%e7%ae%97%22%3e%e6%a8%a1%e9%81%8b%e7%ae%97%3c%2fh2%3e%0a%3ch3%20id%3d%22%e5%90%8c%e9%a4%98%22%3e%e5%90%8c%e9%a4%98%3c%2fh3%3e%0a%3cp%3e%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%20%e8%a1%a8%e7%a4%ba%20%24n%5c%20%7c%5c%20%28a-b%29%24%20%28%20%24n%24%20%e6%95%b4%e9%99%a4%20%24a-b%24%20%29%ef%bc%8c%e7%a8%b1%20%24a%24%20%e8%88%87%20%24b%24%20%e6%a8%a1%20%24n%24%20%e5%90%8c%e9%a4%98%e3%80%82%3c%2fp%3e%0a%3cp%3e%e6%af%94%e5%a6%82%3c%2fp%3e%0a%3cp%3e7%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%3c%2fp%3e%0a%3cp%3e10%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%3c%2fp%3e%0a%3cp%3e%e5%89%87%e5%8f%af%e4%bb%a5%e8%aa%aa%20%247%20%5cequiv%2010%20%5cpmod%203%24%3c%2fp%3e%0a%3ch4%20id%3d%22%e8%ad%89%e6%98%8e%22%3e%e8%ad%89%e6%98%8e%3a%3c%2fh4%3e%0a%3cp%3e%e5%b0%8d%e6%96%bc%20%24a%20%5cequiv%20b%20%5cpmod%20k%20%24%3c%2fp%3e%0a%3cp%3e%e4%bb%a4%20%24a%20%3d%20ks%20%2b%20r%2c%5c%20b%20%3d%20kt%20%2b%20r%24%3c%2fp%3e%0a%3cp%3e%e5%85%a9%e5%bc%8f%e7%9b%b8%e6%b8%9b%e5%be%97%20%24a-b%20%3d%20k%28s-t%29%24%3c%2fp%3e%0a%3cp%3e%e8%ad%89%e6%98%8e%e7%b5%90%e6%9d%9f%3c%2fp%3e%0a%3ch3%20id%3d%22%e5%8a%a0%e4%b9%98%e6%b3%95%e6%80%a7%e8%b3%aa%22%3e%e5%8a%a0%e4%b9%98%e6%b3%95%e6%80%a7%e8%b3%aa%3c%2fh3%3e%0a%3cp%3e%e5%a6%82%e6%9e%9c%20%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%2c%20%24c%20%5cequiv%20d%20%5cpmod%20n%20%24%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&t=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#什麼是數論>什麼是數論</a></li><li><a href=#模運算>模運算</a><ul><li><a href=#同餘>同餘</a><ul><li><a href=#證明>證明:</a></li></ul></li><li><a href=#加乘法性質>加乘法性質</a><ul><li><a href=#證明-1>證明:</a></li></ul></li><li><a href=#需要注意的地方>需要注意的地方</a></li></ul></li><li><a href=#快速幂取模>快速幂取模</a><ul><li><a href=#快速冪>快速冪</a><ul><li><a href=#遞迴版本>遞迴版本</a></li></ul></li></ul></li><li><a href=#最大公因數>最大公因數</a><ul><li><a href=#因數>因數</a></li><li><a href=#公因數與最大公因數gcd>公因數與最大公因數(GCD)</a></li><li><a href=#最大公因數性質>最大公因數性質</a></li><li><a href=#找到最大公因數>找到最大公因數</a></li><li><a href=#貝祖定理bezouts-thm>貝祖定理(Bezout&rsquo;s thm)</a></li></ul></li><li><a href=#質數>質數</a></li><li><a href=#模逆元>模逆元</a><ul><li><a href=#求模逆元>求模逆元</a></li></ul></li><li><a href=#費馬小定理與質數檢驗>費馬小定理與質數檢驗</a><ul><li><a href=#費馬小定理>費馬小定理</a></li><li><a href=#miller-rabin>Miller-Rabin</a></li></ul></li><li><a href=#中國剩餘定理>中國剩餘定理</a><ul><li><a href=#解法>解法</a></li><li><a href=#主定理>主定理</a></li></ul></li><li><a href=#剩餘系>剩餘系</a><ul><li><a href=#完全剩餘系>完全剩餘系</a><ul><li><a href=#性質>性質：</a></li><li><a href=#證明-2>證明：</a></li></ul></li><li><a href=#簡約既約剩餘系-縮系>簡約(既約)剩餘系 (縮系)</a></li></ul></li><li><a href=#歐拉函數與歐拉定理>歐拉函數與歐拉定理</a><ul><li><a href=#歐拉函數>歐拉函數</a><ul><li><a href=#引理>引理：</a></li></ul></li><li><a href=#歐拉定理>歐拉定理</a></li></ul></li><li><a href=#原根>原根</a></li><li><a href=#多項式與卷積>多項式與卷積</a><ul><li><a href=#波動>波動</a></li><li><a href=#波動快慢>波動快慢</a></li><li><a href=#波動大小>波動大小</a></li><li><a href=#波動起點>波動起點</a></li><li><a href=#波動疊加性>波動疊加性</a></li><li><a href=#傅立葉轉換>傅立葉轉換</a></li><li><a href=#單位根>單位根</a></li><li><a href=#奇偶函數>奇偶函數</a></li><li><a href=#三角函數正交性>三角函數正交性</a></li><li><a href=#傅立葉級數>傅立葉級數</a></li><li><a href=#離散傅立葉轉換dft>離散傅立葉轉換(DFT)</a></li><li><a href=#多項式點值表示法>多項式點值表示法</a></li></ul></li></ul><ul><li><ul><li><a href=#快速傅立葉轉換>快速傅立葉轉換</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">算法筆記-數論</h1><div class=meta><div class=postdate><time datetime="0001-01-01 00:00:00 +0000 UTC" itemprop=datePublished>0001-01-01</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/algorithms rel=tag>algorithms</a></div></div></header><div class=content itemprop=articleBody><ul><li><a href=/posts/algo-index/>算法筆記目錄</a></li></ul><h2 id=什麼是數論>什麼是數論</h2><p>數學的分支，專門研究整數的性質。</p><hr><h2 id=模運算>模運算</h2><h3 id=同餘>同餘</h3><p>$a \equiv b \pmod n $ 表示 $n\ |\ (a-b)$ ( $n$ 整除 $a-b$ )，稱 $a$ 與 $b$ 模 $n$ 同餘。</p><p>比如</p><p>7 除以 3 餘 1</p><p>10 除以 3 餘 1</p><p>則可以說 $7 \equiv 10 \pmod 3$</p><h4 id=證明>證明:</h4><p>對於 $a \equiv b \pmod k $</p><p>令 $a = ks + r,\ b = kt + r$</p><p>兩式相減得 $a-b = k(s-t)$</p><p>證明結束</p><h3 id=加乘法性質>加乘法性質</h3><p>如果 $a \equiv b \pmod n $, $c \equiv d \pmod n $</p><p>則</p><ol><li><p>$a \pm c \equiv b \pm d \pmod n $</p></li><li><p>$ac \equiv bd \pmod n$</p></li></ol><h4 id=證明-1>證明:</h4><p>對於1.， $a \equiv b \pmod n $, $c \equiv d \pmod n $，根據同餘定理可寫成 $a-b=nx$, $c-d=ny$，</p><p>相加整理後得 $(a+c) - (b+d) = n(x+y)$ ，證明結束。</p><p>對於2.，$a \equiv b \pmod n $, $c \equiv d \pmod n $，根據同餘定理可寫成 $a-b=nx$, $c-d=ny$，</p><p>相乘整理後得 $ac - bd = n(by+dx+nxy)$，一樣能表示成 $ac \equiv bd \pmod n$。</p><h3 id=需要注意的地方>需要注意的地方</h3><p>當我們在C++或其他大部分程式語言使用 % 時，a % b被定義成 a-(a/b)*b，</p><p>如果遇到負數時 -8 % 3 應為 1，但程式會算出 -2 ，因此需特別小心，或者寫成 ((a%b)+b)%b。</p><p>另外要注意的則是溢值，如果有加法或乘法時建議先mod後再加乘。</p><hr><h2 id=快速幂取模>快速幂取模</h2><p>當我們想快速計算 $a^n\ mod\ m$ 時，利用快速冪可以在 $O(logn)$ 的時間內完成。</p><h3 id=快速冪>快速冪</h3><p>在計算 $a^n$ 時，可以透過遞迴的概念，先算出 $a^n-1$ ，然後乘上 $a$，</p><p>而快速冪是將 $a^n$ 拆成 $a^\frac{n}{2} \times a^\frac{n}{2}$，如果 $n$ 是奇數就拆成 $a * a^{\lfloor \frac{n}{2}\rfloor } \times a^{\lfloor \frac{n}{2}\rfloor }$，這樣下去遞迴，便可以從 $O(n)$ 降到 $O(log\ n)$</p><h4 id=遞迴版本>遞迴版本</h4><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#ff79c6>#define ll long long
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span><span style=color:#6272a4>// 快速冪(不取模)
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ll <span style=color:#50fa7b>fast_pow</span>(ll a, ll n){ <span style=color:#6272a4>// 遞迴版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>n) <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>return</span> fast_pow(a,n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> a;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex><span>        ll r <span style=color:#ff79c6>=</span> fast_pow(a,n<span style=color:#ff79c6>/</span><span style=color:#bd93f9>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> r <span style=color:#ff79c6>*</span> r; 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// 注意不要直接return fast_pow() * fast_pow();
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#6272a4>// 否則會多算一次讓複雜度退化為 O(n)
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>}
</span></span><span style=display:flex><span>ll <span style=color:#50fa7b>fast_pow2</span>(ll a, ll n){ <span style=color:#6272a4>// 迴圈版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    ll ret <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(n){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) ret <span style=color:#ff79c6>*=</span> a;
</span></span><span style=display:flex><span>        n <span style=color:#ff79c6>&gt;&gt;=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>        a <span style=color:#ff79c6>*=</span> a;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>而為了防止溢位，我們先模再乘然後再模</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#ff79c6>#define ll long long
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span><span style=color:#6272a4>// 快速冪取模
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ll <span style=color:#50fa7b>fast_pow_mod</span>(ll a, ll n, ll m){ <span style=color:#6272a4>// 遞迴版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>n) <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>return</span> fast_pow(a,n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex><span>        ll r <span style=color:#ff79c6>=</span> fast_pow(a,n<span style=color:#ff79c6>/</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> r <span style=color:#ff79c6>*</span> r <span style=color:#ff79c6>%</span> m; 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>ll <span style=color:#50fa7b>fast_pow_mod2</span>(ll a, ll n, ll m){ <span style=color:#6272a4>// 迴圈版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    ll ret <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(n){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) ret <span style=color:#ff79c6>=</span> ret <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>        n <span style=color:#ff79c6>&gt;&gt;=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>        a <span style=color:#ff79c6>=</span> a <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=最大公因數>最大公因數</h2><h3 id=因數>因數</h3><p>如果 $ a\ |\ b $，稱 $a$ 為 $b$ 的因數。</p><h3 id=公因數與最大公因數gcd>公因數與最大公因數(GCD)</h3><p>如果 $k\ |\ a$ 且 $k\ |\ b$，則 $k$ 為 $a$ 和 $b$ 的公因數。</p><p>而如果這個 $k$ 是最大的就稱 $k$ 為最大公因數，記為 $gcd(a,b)$ 。</p><h3 id=最大公因數性質>最大公因數性質</h3><ol><li>結合律 $gcd(a,gcd(b,c)) = gcd(gcd(a,b),c)$</li><li>交換律 $gcd(a,b) = gcd(b,a)$</li><li>$gcd(a,0) = |a|$</li><li>$gcd(a,b) = gcd(a,b-a) = gcd(a,b\ mod\ a)$</li></ol><h3 id=找到最大公因數>找到最大公因數</h3><p>利用上面GCD性質的3,4，可以輕鬆算出最大公因數，即歐幾里得算法，或稱輾轉相除法，複雜度 $O(log(min(a,b)))$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>gcd</span>(<span style=color:#8be9fd>int</span> a,<span style=color:#8be9fd>int</span> b){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> b<span style=color:#ff79c6>?</span>gcd(b,a<span style=color:#ff79c6>%</span>b)<span style=color:#ff79c6>:</span>a;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=貝祖定理bezouts-thm>貝祖定理(Bezout&rsquo;s thm)</h3><p>對於所有整數a,b，存在兩個整數x,y使 $ax+by=gcd(a,b)$</p><p>告訴我們如果已知a,b，想求x,y使得$ax+by=gcd(a,b)$，可以利用遞迴求出 (b,a mod b)的答案後算出 (a,b)的答案，</p><p>設 $ax_1 + by_1 = gcd(a,b)$，$bx_2 + (a\ mod\ b)y_2 = gcd(b,a\ mod\ b)$，</p><p>又根據性質 $gcd(a,b) = gcd(b,a\ mod\ b)$，</p><p>得 $ax_1 + by_1 = bx_2 + (a\ mod\ b)y_2$，</p><p>改寫成 $ax_1 + by_1 = bx_2 + (a - \lfloor \frac{a}{b} \rfloor b )y_2$，</p><p>化簡後得 $ax_1 + by_1 = ay_2 + b(x_2 - \lfloor \frac{a}{b} \rfloor y_2 ) $，</p><p>$(x_1,y_1)=(y_2,x_2 - \lfloor \frac{a}{b} \rfloor y_2)$</p><p>而這樣就很像歐幾里得算法的擴展版本，因此叫做擴展歐幾里得算法。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#6272a4>// 回傳 (d,x,y) 滿足 ax+by=gcd(a,b) = d
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>tuple<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span>,<span style=color:#8be9fd>int</span>,<span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> ExtGcd(<span style=color:#8be9fd>int</span> a,<span style=color:#8be9fd>int</span> b){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>b) <span style=color:#ff79c6>return</span> make_tuple(a,<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> d,x,y;
</span></span><span style=display:flex><span>    tie(d,x,y) <span style=color:#ff79c6>=</span> ExtGcd(b,a<span style=color:#ff79c6>%</span>b);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#50fa7b>make_tuple</span>(d,y,x<span style=color:#ff79c6>-</span>(a<span style=color:#ff79c6>/</span>b)<span style=color:#ff79c6>*</span>y);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>如果怕麻煩當然也可以寫成迴圈，或是用 reference 傳 $x,y$</p><hr><h2 id=質數>質數</h2><p>如果 $p$ 的正因數只有 $1$ 和 $p$，則可說 $p$ 為質數。</p><p>現在我們寫一個大家都會，已經熟悉到爛的質數判斷，複雜度 $O(n)$，稱為試除法</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>isPrime</span>(<span style=color:#8be9fd>int</span> n){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&lt;</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>&lt;=</span>n;i<span style=color:#ff79c6>++</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>%</span>i<span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>為了提高效率，其實只要判斷到 $\sqrt{n}$ 就好，複雜度 $O(\sqrt{n})$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>isPrime</span>(<span style=color:#8be9fd>int</span> n){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&lt;</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>*</span>i<span style=color:#ff79c6>&lt;=</span>n;i<span style=color:#ff79c6>++</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>%</span>i<span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>而另一種經典寫法就是 埃拉托斯特尼篩法(Eratosthenes)，複雜度 $O(n\log\log n)$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>bool</span> isPrime[N];
</span></span><span style=display:flex><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>eratosthenes</span>(){
</span></span><span style=display:flex><span>    fill(isPrime,isPrime<span style=color:#ff79c6>+</span>N,<span style=color:#8be9fd;font-style:italic>true</span>);
</span></span><span style=display:flex><span>    isPrime[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> isPrime[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>*</span>i<span style=color:#ff79c6>&lt;</span>N;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(isPrime[i]){
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> j<span style=color:#ff79c6>=</span>i<span style=color:#ff79c6>*</span>i;j<span style=color:#ff79c6>&lt;</span>N;j<span style=color:#ff79c6>+=</span>i)
</span></span><span style=display:flex><span>                isPrime[j] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>但埃氏篩法有個問題是一個合數可能會被很多質數檢查，我們想要它只會被最小的質因數篩到。我們枚舉每個數，如果它沒被篩掉，就丟進質數表，然後枚舉質數表，把質數表的每個質數乘上這個數，並且把它標記為已經被篩掉，這樣就可以保證每個合數只會被最小的質因數篩到。</p><p>此算法的複雜度為 $O(n)$，而且可以順便算出每個數的最小質因數，</p><p>稱為線性篩法，在之後的歐拉函數與Mobius函數之類的積性函數可以使用。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>int</span> minPrime[N];
</span></span><span style=display:flex><span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> primes;
</span></span><span style=display:flex><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>linearSieve</span>(){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>&lt;</span>N;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>minPrime[i]){
</span></span><span style=display:flex><span>          primes.push_back(i);
</span></span><span style=display:flex><span>          minPrime[i] <span style=color:#ff79c6>=</span> i;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> <span style=color:#8be9fd;font-style:italic>p</span>:primes){
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span>(i<span style=color:#ff79c6>*</span>p<span style=color:#ff79c6>&gt;=</span>N) <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>            minPrime[i<span style=color:#ff79c6>*</span>p] <span style=color:#ff79c6>=</span> p;
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span>(i<span style=color:#ff79c6>%</span>p<span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=模逆元>模逆元</h2><p>模逆元就像倒數，因此又叫模倒數、模反元，若 $ab \equiv 1 \pmod n$，則 $a$ 與 $b$ 互為模 $n$ 的模逆元，記作 $a \equiv b^{-1} \pmod n$。</p><p>模逆元存在的充分必要條件為 $a$ 與 $n$ 互質，證明可使用貝祖定理。</p><h3 id=求模逆元>求模逆元</h3><p>可以使用擴展歐幾里得算法，求 $ax+bn=1$ 的 $x$，如果有解，則通解為 $x+kn$。</p><hr><h2 id=費馬小定理與質數檢驗>費馬小定理與質數檢驗</h2><p>要判斷一個正整數 n 是不是質數，除了篩法跟試除法外，還有一個利用費馬小定理成功在 $O(log\ n)$ 內解決問題，</p><p>在了解這個算法之前，先看看什麼是費馬小定理。</p><h3 id=費馬小定理>費馬小定理</h3><p>如果 $a$ 是整數， $n$ 是質數，則 $ a^{n-1} \equiv 1 \pmod n $ 一定成立，</p><p>注意這裡的關係是若 p 則 q，因此如果 $ a^{n-1} \equiv 1 \pmod n $ 成立， 那 n 不一定是質數，</p><p>如果 n 不是質數卻符合上述式子時，我們稱這個 n 為偽質數。</p><h3 id=miller-rabin>Miller-Rabin</h3><p>我們要試著利用費馬小定理檢驗質數，只要找一個 $a$ 使得 $a^{n-1}$ 與 $1$ 同餘就判定 $n$ 為質數</p><p>但偽質數的存在會讓演算法無法保證正確性，</p><p>而其實出錯的機率還滿低的，我們只要根據 $n$ 的範圍挑幾個 $a$ 去檢驗就可以保證不出錯了。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#6272a4>// 如果 n &lt; 2^32 則挑選 2, 7, 61
</span></span></span><span style=display:flex><span><span style=color:#6272a4>// 如果 n &lt; 2^64 則挑選 2, 325, 9375, 28178, 450775, 9780504, 1595265022
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>
</span></span><span style=display:flex><span><span style=color:#ff79c6># define ll long long
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span><span style=color:#6272a4>// 注意long long 乘法可能會溢位，那就需要自己寫乘法跟快速冪函數了
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ll <span style=color:#50fa7b>pow</span>(ll a, ll n, ll m){ <span style=color:#6272a4>// 快速冪
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    ll ret <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(n){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) ret <span style=color:#ff79c6>=</span> ret <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>        n <span style=color:#ff79c6>&gt;&gt;=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>        a <span style=color:#ff79c6>=</span> a <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>miller_rabin</span>(ll a,ll n){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&lt;</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>%</span><span style=color:#bd93f9>2</span><span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>return</span> n<span style=color:#ff79c6>!=</span><span style=color:#bd93f9>2</span>;
</span></span><span style=display:flex><span>    a<span style=color:#ff79c6>%=</span>n;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>a) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    ll u <span style=color:#ff79c6>=</span> n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, t<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(u<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>){
</span></span><span style=display:flex><span>        u<span style=color:#ff79c6>/=</span><span style=color:#bd93f9>2</span>;
</span></span><span style=display:flex><span>        t<span style=color:#ff79c6>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    ll x <span style=color:#ff79c6>=</span> pow(a,u,n);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;i<span style=color:#ff79c6>&lt;</span>t;<span style=color:#ff79c6>++</span>i){
</span></span><span style=display:flex><span>        ll nx <span style=color:#ff79c6>=</span> x <span style=color:#ff79c6>*</span> x <span style=color:#ff79c6>%</span> n;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(nx<span style=color:#ff79c6>==</span><span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&amp;&amp;</span> x<span style=color:#ff79c6>!=</span><span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&amp;&amp;</span> x<span style=color:#ff79c6>!=</span>n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
</span></span><span style=display:flex><span>        x <span style=color:#ff79c6>=</span> nx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> x<span style=color:#ff79c6>!=</span><span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=中國剩餘定理>中國剩餘定理</h2><p>&#171;孫子算經&#187;：<code>有物不知其數，三三數之賸二，五五數之賸三，七七數之賸二，問物幾何？</code></p><p>翻成白話文就是求 $x$ 滿足</p><p>$$ \left\{ \begin{aligned} x \equiv 2 \pmod 3 \\ x \equiv 3 \pmod 5 \\ x \equiv 2 \pmod 7 \end{aligned} \right. $$</p><p>而這題不只有一個答案</p><h3 id=解法>解法</h3><p>假設 $x = a + b + c$，滿足</p><p>$$ \left\{ \begin{aligned} a \equiv 2 \pmod 3 \\ a \equiv 0 \pmod 5 \\ a \equiv 0 \pmod 7 \end{aligned} \right. $$</p><p>$$ \left\{ \begin{aligned} b \equiv 0 \pmod 3 \\ b \equiv 3 \pmod 5 \\ b \equiv 0 \pmod 7 \end{aligned} \right. $$</p><p>$$ \left\{ \begin{aligned} c \equiv 0 \pmod 3 \\ c \equiv 0 \pmod 5 \\ c \equiv 2 \pmod 7 \end{aligned} \right. $$</p><p>可以發現 $a$ 是 $5$ 跟 $7$ 的公倍數，
$b$ 是 $3$ 跟 $7$ 的公倍數，
$c$ 是 $3$ 跟 $5$ 的公倍數，</p><p>$a = 35p \equiv 2 \pmod 3$，$p$ 可為 $1$，
$b = 21q \equiv 3 \pmod 5$，$q$ 可為 $3$，
$c = 15r \equiv 2 \pmod 7$，$r$ 可為 $2$。</p><p>因此 $x$ 其中一解為 $35 \times 1 + 21 \times 3 + 15 \times 2 = 128$，</p><p>而我們想找通解，就取 3 5 7 的最小公倍數 105 乘上參數 t，</p><p>通解為 $128+105t$，</p><p>當 t=-1 時，$x = 23$ 為最小解。</p><h3 id=主定理>主定理</h3><p>如果 $m = m_1m_2&mldr;m_n$ 且 $m_1$ 到 $m_n$ 兩兩互質，而一定有 $x$ 滿足 $x \equiv x_i \pmod {m_i}, \forall 1 \le i \le k$</p><hr><h2 id=剩餘系>剩餘系</h2><p>如果將一個整數集合裡的每個數模 $n$ 後的所有餘數重新建構新的集合，稱這個新集合為模 $n$ 的剩餘系。</p><h3 id=完全剩餘系>完全剩餘系</h3><p>如果一個整數集合裡的每個數模 $n$ 後兩兩不同餘，且大小為 $n\ (0 \sim n-1)$ 則稱這個集合為完全剩餘系。</p><h4 id=性質>性質：</h4><p>若有模 $n$ 的完全剩餘系 $r$ ， 對於任意的 $a \in \Bbb{Z}, b \in \Bbb{Z}$ 且 $gcd(a,n)=1$，則 $\left\{ar_i + b, \forall 0 \le i \le n-1\right\}$ 也是模 $n$ 的完全剩餘系。</p><h4 id=證明-2>證明：</h4><p>反證法，如果有 $ar_i + b \equiv ar_j + b \pmod n$，那麼 $n | a(r_i-r_j)$ ，但 $gcd(a,n)=1$，出現矛盾。</p><h3 id=簡約既約剩餘系-縮系>簡約(既約)剩餘系 (縮系)</h3><p>從一個模 $n$ 的完全剩餘系中選幾個數構成子集合使得這幾個數都跟 $n$ 互質，則這個子集合稱為模 $n$ 的既約剩餘系。</p><hr><h2 id=歐拉函數與歐拉定理>歐拉函數與歐拉定理</h2><h3 id=歐拉函數>歐拉函數</h3><p>定義歐拉函數 $\varphi(n)$ 為小於 $n$ 且與 $n$ 互質的數的個數，就是 $1$ 到 $n-1$ 中有多少個數與 $n$ 互質。</p><h4 id=引理>引理：</h4><ol><li>如果 $p$ 是質數，則 $\varphi(p) = p-1$。</li><li>如果 $p$ 是質數，則 $\varphi(p^k) = p^{k-1}(p-1)$。</li><li>如果 $m$ 與 $n$ 互質，則 $\varphi(mn) = \varphi(m)\varphi(n)$。</li><li>模 $n$ 的既約剩餘系大小就是 $\varphi(n)$。</li></ol><p>現在把正整數 $n$ 做質因數分解</p><p>若 $n = p_1^{c_1}p_2^{c_2}&mldr;p_n^{c_n}$</p><p>，根據引理得</p><p>$\varphi(n) = \varphi(p_1^{c_1})\varphi(p_2^{c_2})&mldr; \varphi(p_k^{c_k}) $</p><p>$ = p_1^{c_1-1}(p_1-1)p_2^{c_2-1}(p_2-1) \cdots p_k^{c_k-1}(p_k-1)$</p><p>$= n \prod_{p | n}(1-\frac{1}{p})$。</p><h3 id=歐拉定理>歐拉定理</h3><p>如果 $a$ 與 $n$ 互質，則 $a^{\varphi(n)} \equiv 1 \pmod n$，如果 $n$ 是質數，證明了前面<a href=#%E8%B2%BB%E9%A6%AC%E5%B0%8F%E5%AE%9A%E7%90%86>費馬小定理</a>。</p><hr><p>歐拉定理與費馬小定理皆可處理大數問題</p><p>且常常用於密碼學(比如RSA加密)。</p><hr><h2 id=原根>原根</h2><p>對於 gcd(a,n)=1 的正整數 a，如果 d 是最小的正整數，使得 $a^d \equiv 1 \pmod n$，則稱 d 是 a 在模 n 下的階，記做 $ord_n(a)$，且 $ord_n(a)$ 一定 $\le \varphi(n)$，而如果 $ord_n(a) = \varphi(n)$，則稱 a 為模 n 的原根。</p><hr><h2 id=多項式與卷積>多項式與卷積</h2><h3 id=波動>波動</h3><p>波動無時無刻都在我們身邊，所有的東西都在振動，振動可以用連續函數表示，
最平穩的振動就是正弦波，表示為 $sin(x)$，畫到圖上以 y 軸表示振福，x 軸表示時間。</p><h3 id=波動快慢>波動快慢</h3><p>我們用頻率來表示波動的快慢，頻率越高，波動越快。</p><p>比如聲音的頻率，人類聽覺能聽到的頻率範圍是 20Hz 到 20kHz，也就是 20 到 20000 個振動。</p><h3 id=波動大小>波動大小</h3><p>我們用振幅來表示波動的大小，振幅越大，波動越大。</p><h3 id=波動起點>波動起點</h3><p>我們用相位(Phase)來表示波動的起點。</p><h3 id=波動疊加性>波動疊加性</h3><p>所有的波動都可以疊加，相同方向的波會相加，反則抵銷。</p><p>寫成數學式就是多個函數相加。</p><h3 id=傅立葉轉換>傅立葉轉換</h3><p>此部分與 線性代數 較為相關，在 OI 上通常用於解多項式乘法問題。</p><p><a href=/posts/LinearAlgebra/linear-index>線性代數筆記</a></p><p>由於波可以以時間角度來看，即以橫軸為時間，縱軸為振幅，但是也可以以頻率角度來看，即以橫軸為頻率，縱軸為振幅。</p><p>把時域轉換到頻域的過程就是傅立葉轉換，而我們也能反向轉換。</p><p>在了解傅立葉轉換前，需要了解一些先備知識。</p><h3 id=單位根>單位根</h3><p>假設我們已經知道複數。</p><p>對於 $x^n = 1$，則稱 $x$ 為 $n$ 次單位根。</p><p>對於一個 $n$ 次單位根，在複數平面就是把複數單位圓切成 $n$ 份，每個數 $w^k_n (k \in \left[ 0, n-1 \right])$</p><h3 id=奇偶函數>奇偶函數</h3><ul><li>奇函數：$f(x) = -f(-x)$，比如 $sin(x)$</li><li>偶函數：$f(x) = f(-x)$，比如 $cos(x)$</li></ul><h3 id=三角函數正交性>三角函數正交性</h3><ul><li>$sin(x)cos(x) = \frac{1}{2}sin(2x)$</li><li>$sin^2(x) + cos^2(x) = 1$</li><li>$sin(x)sin(y) + cos(x)cos(y) $<br>$ = \frac{1}{2}sin(x+y) + \frac{1}{2}sin(x-y)$</li><li>$sin(x)cos(y) - cos(x)sin(y) $<br>$ = \frac{1}{2}sin(x+y) - \frac{1}{2}sin(x-y)$</li><li>$sin(mx)cos(nx) $<br>$ = \frac{1}{2}sin(m+n)x + \frac{1}{2}sin(m-n)x$</li><li>$sin(mx)sin(nx) $<br>$= -(\frac{1}{2}cos(m+n)x - \frac{1}{2}cos(m-n)x)$</li><li>$cos(mx)cos(nx) $<br>$ = \frac{1}{2}cos(m+n)x - \frac{1}{2}cos(m-n)x$</li><li>$e^{ix} = cos(x) + isin(x)$</li><li>$\int_{-\pi}^{\pi}sin(mx)cos(nx)dx = 0 (m \neq \pm n)$</li><li>$\int_{-\pi}^{\pi}sin(mx)sin(nx)dx = 0 (m \neq \pm n)$</li><li>$\int_{-\pi}^{\pi}cos(mx)cos(nx)dx = 0 (m \neq \pm n)$</li><li>$\int_{-\pi}^{\pi}sin(mx)cos(mx)dx = 0$</li><li>$\int_{-\pi}^{\pi}sin(mx)sin(mx)dx = \pi $</li><li>$\int_{-\pi}^{\pi}cos(mx)cos(mx)dx = \pi $</li></ul><h3 id=傅立葉級數>傅立葉級數</h3><p>法國數學家、物理學家傅立葉宣稱任何週期函數 $f(x+T) = f(x)$ 皆可用傅立葉級數表示。(不正確)</p><p>而德國的數學家狄利克雷給了週期函數可轉成傅立葉級數的條件(Dirichelet&rsquo;s theorem)：</p><ul><li>函數必須有界，即 $\forall x, |f(x)| \le M$，其中 $M$ 為正實數。</li><li>任意閉區間內除了有限個點外，函數必須連續。</li><li>任意閉區間內，函數必須僅包含有限個極值。</li><li>一週期內，$|f(x)|$ 積分必須收斂。</li></ul><p>設週期函數 $f(x)$，週期為 $2\pi$。對任意整數 $n$，$f(x) = f(x+2n\pi)$，我們可以選擇考慮區間 $\left[ 0,2\pi \right]$，也可以考慮 $\left[ -\pi,\pi \right]$。</p><p>因為函數可以分解成奇偶函數的和，現在有一個由多個 $cos(x)$ 函數與 $sin(x)$ 函數疊合而成的函數</p><p>$T(x) = c_0 + c_1cos(x) + c_2cos(2x) + \cdots + c_n cos(nx) + $</p><p>$d_1 sin(x) + d_2 sin(2x) + \cdots + d_n sin(nx)$</p><p>這種形式的函數稱為三角多項式(trigonometric polynomial)，如果 $c_n, d_n \neq 0$，則 $T(x)$ 為 $n$ 階。</p><p>接著我們考慮區間 $\left[ 0,2\pi \right]$，$W$ 為 $C\left[a,b\right]$ 中有限維度的子空間，對連續函數 $f$ 做近似，即 $f$ 在 $W$ 的正交投影，設 $W$ 的正則基底為 $\left\{ g_0,g_1,\cdots,g_n \right\}$，則 $f$ 在 $W$ 的正交投影為</p><p>$ proj_{W} f = \langle f,g_0 \rangle g_0 + \langle f,g_1 \rangle g_1 + \cdots + \langle f,g_n \rangle g_n$。</p><p>$W$ 的正則基底可以對 $1,cos(x),cos(2x),\cdots,cos(nx),sin(x),sin(2x),\cdots,sin(nx)$ 進行正交化，得到正則基底</p><p>$$ g_0 = \frac{1}{\sqrt{2\pi}}, g_1 = \frac{1}{\sqrt{\pi}} cos(x), g_2 = \frac{1}{\sqrt{\pi}} cos(2x), \cdots, $$</p><p>$$ g_n = \frac{1}{\sqrt{\pi}} cos(nx), g_{n+1} = \frac{1}{\sqrt{\pi}} sin(x), g_{2n} = \frac{1}{\sqrt{\pi}} sin(nx)$$</p><p>定義係數</p><p>$a_0 = \frac{2}{\sqrt{2\pi}}\langle f,g_0 \rangle, a_1 = \frac{1}{\sqrt{\pi}}\langle f,g_1 \rangle , \cdots , a_n = \frac{1}{\sqrt{\pi}}\langle f,g_n \rangle$</p><p>$b_1 = \frac{1}{\sqrt{\pi}}\langle f,g_{n+1} \rangle , \cdots , b_n = \frac{1}{\sqrt{\pi}}\langle f,g_{2n} \rangle$</p><p>代入原正交投影式，得</p><p>$ proj_{W} f = \frac{a_0}{2} + \left[ a_1 cos(x) + \cdots + a_n cos(nx) \right] + $</p><p>$\left[ b_1 sin(x) + \cdots + b_n sin(nx) \right]$</p><p>就是我們常看到的 $F_n(x) = \frac{a_0}{2} + \sum_{k=1}^{n} (a_k cos(kx) + b_k sin(kx))$</p><p>其中 $a_k,b_k$ 稱為傅立葉係數，</p><p>$a_k = \frac{2}{\pi}\int_{0}^{2\pi} f(x) cos(kx) dx$</p><p>$b_k = \frac{2}{\pi}\int_{0}^{2\pi} f(x) sin(kx) dx$</p><p>$F_n(x)$ 稱為傅立葉級數。</p><p>剛剛我們將函數的週期設為 $2\pi$，現在我們將週期設為 $2\pi T$，考慮區間 $\left[ \frac{-T}{2}, \frac{T}{2} \right]$，變數變換 $\frac{t}{T} = \frac{x}{2\pi}$，</p><p>$x = \frac{2\pi t}{T}$，代入傅立葉級數 $F(x)$，得</p><p>$\large{F(x) = \frac{a_0}{2} + \sum_{k=1}^{\infty} (a_k cos(k\frac{2\pi t}{T}) + b_k sin(k\frac{2\pi t}{T}))}$</p><p>$\large{a_k = \frac{2}{T} \int_\frac{-T}{2}^\frac{T}{2} f(t) cos(\frac{2\pi kt}{T}) dt, k=0,1,2,\cdots }$</p><p>$\large{b_k = \frac{2}{T} \int_\frac{-T}{2}^\frac{T}{2} f(t) sin(\frac{2\pi kt}{T}) dt, k=1,2,\cdots }$</p><p>我們進一步利用歐拉公式 $e^{ix} = cos(x) + isin(x)$，將傅立葉級數改寫，</p><p>$\large{F(x) = \sum_{k=-\infty}^{\infty} c_k e^{ikx}}$</p><p>$\large{c_k = \frac{1}{T} \int_\frac{-T}{2}^\frac{T}{2} f(t) e^{\frac{-2\pi ikt}{T}} dt, k \in \mathbb{Z}}$</p><h3 id=離散傅立葉轉換dft>離散傅立葉轉換(DFT)</h3><p>因為電腦只能處理離散的資料，所以要將連續的傅立葉級數轉換成離散的傅立葉級數，也就是積分變成求和，為了跟 $c_k$ 區分，用 $y_k$ 表示離散傅立葉轉換的結果</p><p>$\large{y_k = \sum_{j=0}^{n-1}x_j e^{\frac{-2\pi ikj}{n}}}$</p><p>回顧之前的單位根，可以將原根寫成</p><p>$\large{w_n^k = e^\frac{-2\pi ik}{n} = cos(\frac{2k\pi}{n}) + isin(\frac{2k\pi}{n})}$</p><p>將離散傅立葉轉換表示成矩陣形式 $y = Fx$，</p><p>$$ \left[ \begin{matrix} y_0 \\ y_1 \\ y2 \\ \vdots \\ y_{n-1} \end{matrix} \right] = \left[ \begin{matrix} 1 & 1 & 1 & \cdots & 1 \\ 1 & w_n^1 & w_n^2 & \cdots & w_n^{n-1} \\ 1 & w_n^2 & w_n^4 & \cdots & w_n^{2(n-1)} \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 1 & w_n^{n-1} & w_n^{2(n-1)} & \cdots & w_{n}^{(n-1)^2} \end{matrix} \right] \left[ \begin{matrix} x_0 \\ x_1 \\ x_2 \\ \vdots \\ x_{n-1} \end{matrix} \right]$$</p><p>$F$ 稱為傅立葉矩陣，而要逆變換時其實就是算 $F^{-1}y = x$，而接下來我們最後的目標就是要能快速算出矩陣乘法</p><h3 id=多項式點值表示法>多項式點值表示法</h3><p>設一堆多項式</p><p>$$ \left\{ \begin{align} & y_0 = a_0 + a_1x_0 + a_1x_0^2 + \cdots + a_nx_0^n \\ & y1 = a_0 + a_1x_1 + a_2x_1^2 + \cdots + a_nx_1^n \\ & y2 = a_0 + a_1x_2 + a_2x_2^2 + \cdots + a_nx_2^n \\ \vdots \\ & y_{n-1} = a_0 + a_1x_{n-1} + a_2x_{n-1}^2 + \cdots + a_nx_{n-1}^{n-1} \end{align} \right. $$</p><p>我們知道兩點構成一次函數，三點構成二次函數，所以 $n+1$ 個點構成 $n$ 次函數。</p><p>我們把 $x^n = 1$ 的單位根都代入多項式，看起來不就像剛剛的傅立葉矩陣嗎？</p><h1 id=我們成功把物理的傅立葉轉換跟-oi-上的結合了>我們成功把物理的傅立葉轉換跟 OI 上的結合了！</h1><h3 id=快速傅立葉轉換>快速傅立葉轉換</h3><p>然而如果直接計算乘法的話，複雜度是 $O(n^2)$，</p><p>假設 $n = 2^k$，我們可以把函式拆成奇偶項，</p><p>$A(x) = (a_0 + a_2x^2 + a_4x^4 + \cdots + a_{n-2}x^{n-2}) $</p><p>$+ (a_1x + a_3x^3 + \cdots + a_{n-1}x^{n-1})$</p><p>設 $A_0 = (a_0 + a_2x + \cdots + a_{n-2}x^{\frac{n}{2}-1}),$</p><p>$A_1 = (a_1 + a_3x + \cdots + a_{n-1}x^{\frac{n}{2}-1})$</p><p>得 $A(x) = A_0(x^2) + xA_1(x^2)$</p><p>寫成單位根的形式</p><p>$A(w_n^k) = A_0(w_n^{2k}) + w_n^kA_1(w_n^{2k})$</p><p>成功把計算量縮小一半，同理將 $A_0$ 和 $A_1$ 也拆成奇偶項，再用同樣的方法，在遞迴的底層(一個點)用 $O(n)$ 計算後往上合併，計算量縮小到 $O(nlogn)$。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#ff79c6>const</span> <span style=color:#8be9fd>double</span> pi <span style=color:#ff79c6>=</span> acos(<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>);
</span></span><span style=display:flex><span><span style=color:#ff79c6>typedef</span> complex<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>double</span><span style=color:#ff79c6>&gt;</span> cd;
</span></span><span style=display:flex><span><span style=color:#ff79c6>struct</span> <span style=color:#50fa7b>FFT</span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> n,rev[<span style=color:#bd93f9>1</span><span style=color:#ff79c6>&lt;&lt;</span><span style=color:#bd93f9>20</span>];
</span></span><span style=display:flex><span>    cd w[<span style=color:#bd93f9>1</span><span style=color:#ff79c6>&lt;&lt;</span><span style=color:#bd93f9>20</span>];
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>init</span>(<span style=color:#8be9fd>int</span> _n){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>-&gt;</span>n <span style=color:#ff79c6>=</span> _n;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;i<span style=color:#ff79c6>&lt;</span>_n;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>            w[i] <span style=color:#ff79c6>=</span> cd(cos(<span style=color:#bd93f9>2</span><span style=color:#ff79c6>*</span>pi<span style=color:#ff79c6>/</span>_n<span style=color:#ff79c6>*</span>i),sin(<span style=color:#bd93f9>2</span><span style=color:#ff79c6>*</span>pi<span style=color:#ff79c6>/</span>_n<span style=color:#ff79c6>*</span>i)); <span style=color:#6272a4>// 單位根
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        }
</span></span><span style=display:flex><span>        <span style=color:#8be9fd>int</span> lgn <span style=color:#ff79c6>=</span> __lg(_n);
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;i<span style=color:#ff79c6>&lt;</span>_n;i<span style=color:#ff79c6>++</span>){ <span style=color:#6272a4>// 位元反轉
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>            <span style=color:#8be9fd>int</span> tmp <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> j<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;j<span style=color:#ff79c6>&lt;</span>lgn;j<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>if</span>(i<span style=color:#ff79c6>&amp;</span>(<span style=color:#bd93f9>1</span><span style=color:#ff79c6>&lt;&lt;</span>j)) tmp <span style=color:#ff79c6>|=</span> (<span style=color:#bd93f9>1</span><span style=color:#ff79c6>&lt;&lt;</span>(lgn<span style=color:#ff79c6>-</span>j<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            rev[i] <span style=color:#ff79c6>=</span> tmp;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>trans</span>(vector<span style=color:#ff79c6>&lt;</span>cd<span style=color:#ff79c6>&gt;&amp;</span> a, cd<span style=color:#ff79c6>*</span> w){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;i<span style=color:#ff79c6>&lt;</span>n;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span>(i<span style=color:#ff79c6>&lt;</span>rev[i]) swap(a[i],a[rev[i]]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>&lt;=</span>n;i<span style=color:#ff79c6>&lt;&lt;=</span><span style=color:#bd93f9>1</span>){
</span></span><span style=display:flex><span>            <span style=color:#8be9fd>int</span> mid <span style=color:#ff79c6>=</span> i<span style=color:#ff79c6>&gt;&gt;</span><span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#8be9fd>int</span> r <span style=color:#ff79c6>=</span> n<span style=color:#ff79c6>/</span>i;
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> j<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;j<span style=color:#ff79c6>&lt;</span>n;j<span style=color:#ff79c6>+=</span>i){
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> k<span style=color:#ff79c6>=</span><span style=color:#bd93f9>0</span>;k<span style=color:#ff79c6>&lt;</span>mid;k<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>                    cd t <span style=color:#ff79c6>=</span> a[j<span style=color:#ff79c6>+</span>k<span style=color:#ff79c6>+</span>mid]<span style=color:#ff79c6>*</span>w;
</span></span><span style=display:flex><span>                    a[j<span style=color:#ff79c6>+</span>k<span style=color:#ff79c6>+</span>mid] <span style=color:#ff79c6>=</span> a[j<span style=color:#ff79c6>+</span>k]<span style=color:#ff79c6>-</span>t;
</span></span><span style=display:flex><span>                    a[j<span style=color:#ff79c6>+</span>k] <span style=color:#ff79c6>+=</span> t;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>fft</span>(vector<span style=color:#ff79c6>&lt;</span>cd<span style=color:#ff79c6>&gt;&amp;</span> a){
</span></span><span style=display:flex><span>        trans(a,w);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>主頁</a></li><li><a href=/posts>廢文區</a></li><li><a href=/resources>資源</a></li><li><a href=/tags>標籤</a></li><li><a href=/comment>留言區</a></li><li><a href=/about>關於本人</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#什麼是數論>什麼是數論</a></li><li><a href=#模運算>模運算</a><ul><li><a href=#同餘>同餘</a><ul><li><a href=#證明>證明:</a></li></ul></li><li><a href=#加乘法性質>加乘法性質</a><ul><li><a href=#證明-1>證明:</a></li></ul></li><li><a href=#需要注意的地方>需要注意的地方</a></li></ul></li><li><a href=#快速幂取模>快速幂取模</a><ul><li><a href=#快速冪>快速冪</a><ul><li><a href=#遞迴版本>遞迴版本</a></li></ul></li></ul></li><li><a href=#最大公因數>最大公因數</a><ul><li><a href=#因數>因數</a></li><li><a href=#公因數與最大公因數gcd>公因數與最大公因數(GCD)</a></li><li><a href=#最大公因數性質>最大公因數性質</a></li><li><a href=#找到最大公因數>找到最大公因數</a></li><li><a href=#貝祖定理bezouts-thm>貝祖定理(Bezout&rsquo;s thm)</a></li></ul></li><li><a href=#質數>質數</a></li><li><a href=#模逆元>模逆元</a><ul><li><a href=#求模逆元>求模逆元</a></li></ul></li><li><a href=#費馬小定理與質數檢驗>費馬小定理與質數檢驗</a><ul><li><a href=#費馬小定理>費馬小定理</a></li><li><a href=#miller-rabin>Miller-Rabin</a></li></ul></li><li><a href=#中國剩餘定理>中國剩餘定理</a><ul><li><a href=#解法>解法</a></li><li><a href=#主定理>主定理</a></li></ul></li><li><a href=#剩餘系>剩餘系</a><ul><li><a href=#完全剩餘系>完全剩餘系</a><ul><li><a href=#性質>性質：</a></li><li><a href=#證明-2>證明：</a></li></ul></li><li><a href=#簡約既約剩餘系-縮系>簡約(既約)剩餘系 (縮系)</a></li></ul></li><li><a href=#歐拉函數與歐拉定理>歐拉函數與歐拉定理</a><ul><li><a href=#歐拉函數>歐拉函數</a><ul><li><a href=#引理>引理：</a></li></ul></li><li><a href=#歐拉定理>歐拉定理</a></li></ul></li><li><a href=#原根>原根</a></li><li><a href=#多項式與卷積>多項式與卷積</a><ul><li><a href=#波動>波動</a></li><li><a href=#波動快慢>波動快慢</a></li><li><a href=#波動大小>波動大小</a></li><li><a href=#波動起點>波動起點</a></li><li><a href=#波動疊加性>波動疊加性</a></li><li><a href=#傅立葉轉換>傅立葉轉換</a></li><li><a href=#單位根>單位根</a></li><li><a href=#奇偶函數>奇偶函數</a></li><li><a href=#三角函數正交性>三角函數正交性</a></li><li><a href=#傅立葉級數>傅立葉級數</a></li><li><a href=#離散傅立葉轉換dft>離散傅立葉轉換(DFT)</a></li><li><a href=#多項式點值表示法>多項式點值表示法</a></li></ul></li></ul><ul><li><ul><li><a href=#快速傅立葉轉換>快速傅立葉轉換</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&text=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&is_video=false&description=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&body=Check out this article: https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&name=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&description=%3cul%3e%0a%3cli%3e%3ca%20href%3d%22%2fposts%2falgo-index%2f%22%3e%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98%e7%9b%ae%e9%8c%84%3c%2fa%3e%3c%2fli%3e%0a%3c%2ful%3e%0a%3ch2%20id%3d%22%e4%bb%80%e9%ba%bc%e6%98%af%e6%95%b8%e8%ab%96%22%3e%e4%bb%80%e9%ba%bc%e6%98%af%e6%95%b8%e8%ab%96%3c%2fh2%3e%0a%3cp%3e%e6%95%b8%e5%ad%b8%e7%9a%84%e5%88%86%e6%94%af%ef%bc%8c%e5%b0%88%e9%96%80%e7%a0%94%e7%a9%b6%e6%95%b4%e6%95%b8%e7%9a%84%e6%80%a7%e8%b3%aa%e3%80%82%3c%2fp%3e%0a%3chr%3e%0a%3ch2%20id%3d%22%e6%a8%a1%e9%81%8b%e7%ae%97%22%3e%e6%a8%a1%e9%81%8b%e7%ae%97%3c%2fh2%3e%0a%3ch3%20id%3d%22%e5%90%8c%e9%a4%98%22%3e%e5%90%8c%e9%a4%98%3c%2fh3%3e%0a%3cp%3e%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%20%e8%a1%a8%e7%a4%ba%20%24n%5c%20%7c%5c%20%28a-b%29%24%20%28%20%24n%24%20%e6%95%b4%e9%99%a4%20%24a-b%24%20%29%ef%bc%8c%e7%a8%b1%20%24a%24%20%e8%88%87%20%24b%24%20%e6%a8%a1%20%24n%24%20%e5%90%8c%e9%a4%98%e3%80%82%3c%2fp%3e%0a%3cp%3e%e6%af%94%e5%a6%82%3c%2fp%3e%0a%3cp%3e7%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%3c%2fp%3e%0a%3cp%3e10%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%3c%2fp%3e%0a%3cp%3e%e5%89%87%e5%8f%af%e4%bb%a5%e8%aa%aa%20%247%20%5cequiv%2010%20%5cpmod%203%24%3c%2fp%3e%0a%3ch4%20id%3d%22%e8%ad%89%e6%98%8e%22%3e%e8%ad%89%e6%98%8e%3a%3c%2fh4%3e%0a%3cp%3e%e5%b0%8d%e6%96%bc%20%24a%20%5cequiv%20b%20%5cpmod%20k%20%24%3c%2fp%3e%0a%3cp%3e%e4%bb%a4%20%24a%20%3d%20ks%20%2b%20r%2c%5c%20b%20%3d%20kt%20%2b%20r%24%3c%2fp%3e%0a%3cp%3e%e5%85%a9%e5%bc%8f%e7%9b%b8%e6%b8%9b%e5%be%97%20%24a-b%20%3d%20k%28s-t%29%24%3c%2fp%3e%0a%3cp%3e%e8%ad%89%e6%98%8e%e7%b5%90%e6%9d%9f%3c%2fp%3e%0a%3ch3%20id%3d%22%e5%8a%a0%e4%b9%98%e6%b3%95%e6%80%a7%e8%b3%aa%22%3e%e5%8a%a0%e4%b9%98%e6%b3%95%e6%80%a7%e8%b3%aa%3c%2fh3%3e%0a%3cp%3e%e5%a6%82%e6%9e%9c%20%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%2c%20%24c%20%5cequiv%20d%20%5cpmod%20n%20%24%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fja-errorpro.codes%2fposts%2f1%2falgo-number-theory%2f&t=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 ErrorPro</div><div class=footer-right><nav><ul><li><a href=/>主頁</a></li><li><a href=/posts>廢文區</a></li><li><a href=/resources>資源</a></li><li><a href=/tags>標籤</a></li><li><a href=/comment>留言區</a></li><li><a href=/about>關於本人</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script type=text/javascript src=/js/nest.js count=80 color=255,255,255 opacity=0.7></script><img id=Cursor src=/images/cursor/silverwolf/01-Normal.gif>
<script type=text/javascript src=/js/cursor.js></script></html>