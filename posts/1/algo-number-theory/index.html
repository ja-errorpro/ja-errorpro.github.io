<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>算法筆記-數論 | ErrorPro</title><link rel=canonical href=/posts/1/algo-number-theory/><meta name=description content="我覺得現在在看這句話的人超電"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="算法筆記-數論"><meta property="og:description" content="算法筆記目錄 什麼是數論 數學的分支，專門研究整數的性質。
模運算 同餘 $a \equiv b \pmod n $ 表示 $n\ |\ (a-b)$ ( $n$ 整除 $a-b$ )，稱 $a$ 與 $b$ 模 $n$ 同餘。
比如
7 除以 3 餘 1
10 除以 3 餘 1
則可以說 $7 \equiv 10 \pmod 3$
證明: 對於 $a \equiv b \pmod k $
令 $a = ks + r,\ b = kt + r$
兩式相減得 $a-b = k(s-t)$
證明結束
加乘法性質 如果 $a \equiv b \pmod n $, $c \equiv d \pmod n $"><meta property="og:type" content="article"><meta property="og:url" content="/posts/1/algo-number-theory/"><meta property="article:section" content="posts"><meta name=twitter:card content="summary"><meta name=twitter:title content="算法筆記-數論"><meta name=twitter:description content="算法筆記目錄 什麼是數論 數學的分支，專門研究整數的性質。
模運算 同餘 $a \equiv b \pmod n $ 表示 $n\ |\ (a-b)$ ( $n$ 整除 $a-b$ )，稱 $a$ 與 $b$ 模 $n$ 同餘。
比如
7 除以 3 餘 1
10 除以 3 餘 1
則可以說 $7 \equiv 10 \pmod 3$
證明: 對於 $a \equiv b \pmod k $
令 $a = ks + r,\ b = kt + r$
兩式相減得 $a-b = k(s-t)$
證明結束
加乘法性質 如果 $a \equiv b \pmod n $, $c \equiv d \pmod n $"><link rel=stylesheet href=/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><link rel=stylesheet href=/css/highlight.css><link rel=stylesheet href=/css/style-dark.css><link rel=stylesheet href=/css/search.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>主頁</a></li><li><a href=/posts>廢文區</a></li><li><a href=/resources>資源</a></li><li><a href=/tags>標籤</a></li><li><a href=/comment>留言區</a></li><li><a href=/about>關於本人</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=/posts/1/algo-runtime/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=/posts/1/algo-sorting/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=%2fposts%2f1%2falgo-number-theory%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=%2fposts%2f1%2falgo-number-theory%2f&text=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f1%2falgo-number-theory%2f&is_video=false&description=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&body=Check out this article: %2fposts%2f1%2falgo-number-theory%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=%2fposts%2f1%2falgo-number-theory%2f&name=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&description=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98%e7%9b%ae%e9%8c%84%20%e4%bb%80%e9%ba%bc%e6%98%af%e6%95%b8%e8%ab%96%20%e6%95%b8%e5%ad%b8%e7%9a%84%e5%88%86%e6%94%af%ef%bc%8c%e5%b0%88%e9%96%80%e7%a0%94%e7%a9%b6%e6%95%b4%e6%95%b8%e7%9a%84%e6%80%a7%e8%b3%aa%e3%80%82%0a%e6%a8%a1%e9%81%8b%e7%ae%97%20%e5%90%8c%e9%a4%98%20%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%20%e8%a1%a8%e7%a4%ba%20%24n%5c%20%7c%5c%20%28a-b%29%24%20%28%20%24n%24%20%e6%95%b4%e9%99%a4%20%24a-b%24%20%29%ef%bc%8c%e7%a8%b1%20%24a%24%20%e8%88%87%20%24b%24%20%e6%a8%a1%20%24n%24%20%e5%90%8c%e9%a4%98%e3%80%82%0a%e6%af%94%e5%a6%82%0a7%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%0a10%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%0a%e5%89%87%e5%8f%af%e4%bb%a5%e8%aa%aa%20%247%20%5cequiv%2010%20%5cpmod%203%24%0a%e8%ad%89%e6%98%8e%3a%20%e5%b0%8d%e6%96%bc%20%24a%20%5cequiv%20b%20%5cpmod%20k%20%24%0a%e4%bb%a4%20%24a%20%3d%20ks%20%2b%20r%2c%5c%20b%20%3d%20kt%20%2b%20r%24%0a%e5%85%a9%e5%bc%8f%e7%9b%b8%e6%b8%9b%e5%be%97%20%24a-b%20%3d%20k%28s-t%29%24%0a%e8%ad%89%e6%98%8e%e7%b5%90%e6%9d%9f%0a%e5%8a%a0%e4%b9%98%e6%b3%95%e6%80%a7%e8%b3%aa%20%e5%a6%82%e6%9e%9c%20%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%2c%20%24c%20%5cequiv%20d%20%5cpmod%20n%20%24" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=%2fposts%2f1%2falgo-number-theory%2f&t=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#什麼是數論>什麼是數論</a></li><li><a href=#模運算>模運算</a><ul><li><a href=#同餘>同餘</a><ul><li><a href=#證明>證明:</a></li></ul></li><li><a href=#加乘法性質>加乘法性質</a><ul><li><a href=#證明-1>證明:</a></li></ul></li><li><a href=#需要注意的地方>需要注意的地方</a></li></ul></li><li><a href=#快速幂取模>快速幂取模</a><ul><li><a href=#快速冪>快速冪</a><ul><li><a href=#遞迴版本>遞迴版本</a></li></ul></li></ul></li><li><a href=#最大公因數>最大公因數</a><ul><li><a href=#因數>因數</a></li><li><a href=#公因數與最大公因數gcd>公因數與最大公因數(GCD)</a></li><li><a href=#最大公因數性質>最大公因數性質</a></li><li><a href=#找到最大公因數>找到最大公因數</a></li><li><a href=#貝祖定理bezouts-thm>貝祖定理(Bezout&rsquo;s thm)</a></li></ul></li><li><a href=#質數>質數</a></li><li><a href=#中國剩餘定理>中國剩餘定理</a><ul><li><a href=#解法>解法</a></li><li><a href=#主定理>主定理</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">算法筆記-數論</h1><div class=meta><div class=postdate><time datetime="0001-01-01 00:00:00 +0000 UTC" itemprop=datePublished>0001-01-01</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/algorithms rel=tag>algorithms</a></div></div></header><div class=content itemprop=articleBody><ul><li><a href=/posts/1/algo-index/>算法筆記目錄</a></li></ul><h2 id=什麼是數論>什麼是數論</h2><p>數學的分支，專門研究整數的性質。</p><h2 id=模運算>模運算</h2><h3 id=同餘>同餘</h3><p>$a \equiv b \pmod n $ 表示 $n\ |\ (a-b)$ ( $n$ 整除 $a-b$ )，稱 $a$ 與 $b$ 模 $n$ 同餘。</p><p>比如</p><p>7 除以 3 餘 1</p><p>10 除以 3 餘 1</p><p>則可以說 $7 \equiv 10 \pmod 3$</p><h4 id=證明>證明:</h4><p>對於 $a \equiv b \pmod k $</p><p>令 $a = ks + r,\ b = kt + r$</p><p>兩式相減得 $a-b = k(s-t)$</p><p>證明結束</p><h3 id=加乘法性質>加乘法性質</h3><p>如果 $a \equiv b \pmod n $, $c \equiv d \pmod n $</p><p>則</p><ol><li><p>$a \pm c \equiv b \pm d \pmod n $</p></li><li><p>$ac \equiv bd \pmod n$</p></li></ol><h4 id=證明-1>證明:</h4><p>對於1.， $a \equiv b \pmod n $, $c \equiv d \pmod n $，根據同餘定理可寫成 $a-b=nx$, $c-d=ny$，</p><p>相加整理後得 $(a+c) - (b+d) = n(x+y)$ ，證明結束。</p><p>對於2.，$a \equiv b \pmod n $, $c \equiv d \pmod n $，根據同餘定理可寫成 $a-b=nx$, $c-d=ny$，</p><p>相乘整理後得 $ac - bd = n(by+dx+nxy)$，一樣能表示成 $ac \equiv bd \pmod n$。</p><h3 id=需要注意的地方>需要注意的地方</h3><p>當我們在C++或其他大部分程式語言使用 % 時，a % b被定義成 a-(a/b)*b，</p><p>如果遇到負數時 -8 % 3 應為 1，但程式會算出 -2 ，因此需特別小心，或者寫成 ((a%b)+b)%b。</p><p>另外要注意的則是溢值，如果有加法或乘法時建議先mod後再加乘。</p><h2 id=快速幂取模>快速幂取模</h2><p>當我們想快速計算 $a^n\ mod\ m$ 時，利用快速冪可以在 $O(logn)$ 的時間內完成。</p><h3 id=快速冪>快速冪</h3><p>在計算 $a^n$ 時，可以透過遞迴的概念，先算出 $a^n-1$ ，然後乘上 $a$，</p><p>而快速冪是將 $a^n$ 拆成 $a^\frac{n}{2} \times a^\frac{n}{2}$，如果 $n$ 是奇數就拆成 $a * a^{\lfloor \frac{n}{2}\rfloor } \times a^{\lfloor \frac{n}{2}\rfloor }$，這樣下去遞迴，便可以從 $O(n)$ 降到 $O(log\ n)$</p><h4 id=遞迴版本>遞迴版本</h4><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#ff79c6>#define ll long long
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span><span style=color:#6272a4>// 快速冪(不取模)
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ll <span style=color:#50fa7b>fast_pow</span>(ll a, ll n){ <span style=color:#6272a4>// 遞迴版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>n) <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>return</span> fast_pow(a,n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> a;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex><span>        ll r <span style=color:#ff79c6>=</span> fast_pow(a,n<span style=color:#ff79c6>/</span><span style=color:#bd93f9>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> r <span style=color:#ff79c6>*</span> r; 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#6272a4>// 注意不要直接return fast_pow() * fast_pow();
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#6272a4>// 否則會多算一次讓複雜度退化為 O(n)
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>}
</span></span><span style=display:flex><span>ll <span style=color:#50fa7b>fast_pow2</span>(ll a, ll n){ <span style=color:#6272a4>// 迴圈版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    ll ret <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(n){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) ret <span style=color:#ff79c6>*=</span> a;
</span></span><span style=display:flex><span>        n <span style=color:#ff79c6>&gt;&gt;=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>        a <span style=color:#ff79c6>*=</span> a;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>而為了防止溢位，我們先模再乘然後再模</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#ff79c6>#define ll long long
</span></span></span><span style=display:flex><span><span style=color:#ff79c6></span><span style=color:#6272a4>// 快速冪取模
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>ll <span style=color:#50fa7b>fast_pow_mod</span>(ll a, ll n, ll m){ <span style=color:#6272a4>// 遞迴版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>n) <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>return</span> fast_pow(a,n<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>else</span> {
</span></span><span style=display:flex><span>        ll r <span style=color:#ff79c6>=</span> fast_pow(a,n<span style=color:#ff79c6>/</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> r <span style=color:#ff79c6>*</span> r <span style=color:#ff79c6>%</span> m; 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>ll <span style=color:#50fa7b>fast_pow_mod2</span>(ll a, ll n, ll m){ <span style=color:#6272a4>// 迴圈版
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    ll ret <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>while</span>(n){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&amp;</span><span style=color:#bd93f9>1</span>) ret <span style=color:#ff79c6>=</span> ret <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>        n <span style=color:#ff79c6>&gt;&gt;=</span> <span style=color:#bd93f9>1</span>;
</span></span><span style=display:flex><span>        a <span style=color:#ff79c6>=</span> a <span style=color:#ff79c6>*</span> a <span style=color:#ff79c6>%</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> ret;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=最大公因數>最大公因數</h2><h3 id=因數>因數</h3><p>如果 $ a\ |\ b $，稱 $a$ 為 $b$ 的因數。</p><h3 id=公因數與最大公因數gcd>公因數與最大公因數(GCD)</h3><p>如果 $k\ |\ a$ 且 $k\ |\ b$，則 $k$ 為 $a$ 和 $b$ 的公因數。</p><p>而如果這個 $k$ 是最大的就稱 $k$ 為最大公因數，記為 $gcd(a,b)$ 。</p><h3 id=最大公因數性質>最大公因數性質</h3><ol><li>結合律 $gcd(a,gcd(b,c)) = gcd(gcd(a,b),c)$</li><li>交換律 $gcd(a,b) = gcd(b,a)$</li><li>$gcd(a,0) = |a|$</li><li>$gcd(a,b) = gcd(a,b-a) = gcd(a,b\ mod\ a)$</li></ol><h3 id=找到最大公因數>找到最大公因數</h3><p>利用上面GCD性質的3,4，可以輕鬆算出最大公因數，即歐幾里得算法，或稱輾轉相除法，複雜度 $O(log(min(a,b)))$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>int</span> <span style=color:#50fa7b>gcd</span>(<span style=color:#8be9fd>int</span> a,<span style=color:#8be9fd>int</span> b){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> b<span style=color:#ff79c6>?</span>gcd(b,a<span style=color:#ff79c6>%</span>b)<span style=color:#ff79c6>:</span>a;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=貝祖定理bezouts-thm>貝祖定理(Bezout&rsquo;s thm)</h3><p>對於所有整數a,b，存在兩個整數x,y使 $ax+by=gcd(a,b)$</p><p>告訴我們如果已知a,b，想求x,y使得$ax+by=gcd(a,b)$，可以利用遞迴求出 (b,a mod b)的答案後算出 (a,b)的答案，</p><p>設 $ax_1 + by_1 = gcd(a,b)$，$bx_2 + (a\ mod\ b)y_2 = gcd(b,a\ mod\ b)$，</p><p>又根據性質 $gcd(a,b) = gcd(b,a\ mod\ b)$，</p><p>得 $ax_1 + by_1 = bx_2 + (a\ mod\ b)y_2$，</p><p>改寫成 $ax_1 + by_1 = bx_2 + (a - \lfloor \frac{a}{b} \rfloor b )y_2$，</p><p>化簡後得 $ax_1 + by_1 = ay_2 + b(x_2 - \lfloor \frac{a}{b} \rfloor y_2 ) $，</p><p>$(x_1,y_1)=(y_2,x_2 - \lfloor \frac{a}{b} \rfloor y_2)$</p><p>而這樣就很像歐幾里得算法的擴展版本，因此叫做擴展歐幾里得算法。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#6272a4>// 回傳 (d,x,y) 滿足 ax+by=gcd(a,b) = d
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>tuple<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span>,<span style=color:#8be9fd>int</span>,<span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> ExtGcd(<span style=color:#8be9fd>int</span> a,<span style=color:#8be9fd>int</span> b){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>b) <span style=color:#ff79c6>return</span> make_tuple(a,<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#8be9fd>int</span> d,x,y;
</span></span><span style=display:flex><span>    tie(d,x,y) <span style=color:#ff79c6>=</span> ExtGcd(b,a<span style=color:#ff79c6>%</span>b);
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#50fa7b>make_tuple</span>(d,y,x<span style=color:#ff79c6>-</span>(a<span style=color:#ff79c6>/</span>b)<span style=color:#ff79c6>*</span>y);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>如果怕麻煩當然也可以寫成迴圈，或是用 reference 傳 $x,y$</p><h2 id=質數>質數</h2><p>如果 $p$ 的正因數只有 $1$ 和 $p$，則可說 $p$ 為質數。</p><p>現在我們寫一個很基本但暴力的質數判斷，複雜度 $O(n)$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>isPrime</span>(<span style=color:#8be9fd>int</span> n){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&lt;</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>&lt;=</span>n;i<span style=color:#ff79c6>++</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>%</span>i<span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>為了提高效率，其實只要判斷到 $\sqrt{n}$ 就好，複雜度 $O(\sqrt{n})$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>isPrime</span>(<span style=color:#8be9fd>int</span> n){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>&lt;</span><span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>*</span>i<span style=color:#ff79c6>&lt;=</span>n;i<span style=color:#ff79c6>++</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(n<span style=color:#ff79c6>%</span>i<span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>而另一種經典寫法就是 埃拉托斯特尼篩法(Eratosthenes)，複雜度 $O(n\log\log n)$</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>bool</span> isPrime[N];
</span></span><span style=display:flex><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>eratosthenes</span>(){
</span></span><span style=display:flex><span>    fill(isPrime,isPrime<span style=color:#ff79c6>+</span>N,<span style=color:#8be9fd;font-style:italic>true</span>);
</span></span><span style=display:flex><span>    isPrime[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> isPrime[<span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>*</span>i<span style=color:#ff79c6>&lt;</span>N;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(isPrime[i]){
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> j<span style=color:#ff79c6>=</span>i<span style=color:#ff79c6>*</span>i;j<span style=color:#ff79c6>&lt;</span>N;j<span style=color:#ff79c6>+=</span>i)
</span></span><span style=display:flex><span>                isPrime[j] <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>但埃氏篩法有個問題是一個合數可能會被很多質數檢查，我們想要它只會被最小的質因數篩到。我們枚舉每個數，如果它沒被篩掉，就丟進質數表，然後枚舉質數表，把質數表的每個質數乘上這個數，並且把它標記為已經被篩掉，這樣就可以保證每個合數只會被最小的質因數篩到。</p><p>此算法的複雜度為 $O(n)$，而且可以順便算出每個數的最小質因數，</p><p>稱為線性篩法，在之後的歐拉函數與Mobius函數之類的積性函數可以使用。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8be9fd>int</span> minPrime[N];
</span></span><span style=display:flex><span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> primes;
</span></span><span style=display:flex><span><span style=color:#8be9fd>void</span> <span style=color:#50fa7b>linearSieve</span>(){
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> i<span style=color:#ff79c6>=</span><span style=color:#bd93f9>2</span>;i<span style=color:#ff79c6>&lt;</span>N;i<span style=color:#ff79c6>++</span>){
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span>(<span style=color:#ff79c6>!</span>minPrime[i]){
</span></span><span style=display:flex><span>          primes.push_back(i);
</span></span><span style=display:flex><span>          minPrime[i] <span style=color:#ff79c6>=</span> i;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span>(<span style=color:#8be9fd>int</span> <span style=color:#8be9fd;font-style:italic>p</span>:primes){
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span>(i<span style=color:#ff79c6>*</span>p<span style=color:#ff79c6>&gt;=</span>N) <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>            minPrime[i<span style=color:#ff79c6>*</span>p] <span style=color:#ff79c6>=</span> p;
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>if</span>(i<span style=color:#ff79c6>%</span>p<span style=color:#ff79c6>==</span><span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=中國剩餘定理>中國剩餘定理</h2><p>&#171;孫子算經&#187;：<code>有物不知其數，三三數之賸二，五五數之賸三，七七數之賸二，問物幾何？</code></p><p>翻成白話文就是求 $x$ 滿足</p><p>$$ \left\{ \begin{aligned} x \equiv 2 \pmod 3 \\ x \equiv 3 \pmod 5 \\ x \equiv 2 \pmod 7 \end{aligned} \right. $$</p><p>而這題不只有一個答案</p><h3 id=解法>解法</h3><p>假設 $x = a + b + c$，滿足</p><p>$$ \left\{ \begin{aligned} a \equiv 2 \pmod 3 \\ a \equiv 0 \pmod 5 \\ a \equiv 0 \pmod 7 \end{aligned} \right. $$</p><p>$$ \left\{ \begin{aligned} b \equiv 0 \pmod 3 \\ b \equiv 3 \pmod 5 \\ b \equiv 0 \pmod 7 \end{aligned} \right. $$</p><p>$$ \left\{ \begin{aligned} c \equiv 0 \pmod 3 \\ c \equiv 0 \pmod 5 \\ c \equiv 2 \pmod 7 \end{aligned} \right. $$</p><p>可以發現 $a$ 是 $5$ 跟 $7$ 的公倍數，
$b$ 是 $3$ 跟 $7$ 的公倍數，
$c$ 是 $3$ 跟 $5$ 的公倍數，</p><p>$a = 35p \equiv 2 \pmod 3$，$p$ 可為 $1$，
$b = 21q \equiv 3 \pmod 5$，$q$ 可為 $3$，
$c = 15r \equiv 2 \pmod 7$，$r$ 可為 $2$。</p><p>因此 $x$ 其中一解為 $35 \times 1 + 21 \times 3 + 15 \times 2 = 128$，</p><p>而我們想找通解，就取 3 5 7 的最小公倍數 105 乘上參數 t，</p><p>通解為 $128+105t$，</p><p>當 t=-1 時，$x = 23$ 為最小解。</p><h3 id=主定理>主定理</h3><p>如果 $m = m_1m_2&mldr;m_n$ 且 $m_1$ 到 $m_n$ 兩兩互質，而一定有 $x$ 滿足 $x \equiv x_i \pmod {m_i}, \forall 1 \le i \le k$</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>主頁</a></li><li><a href=/posts>廢文區</a></li><li><a href=/resources>資源</a></li><li><a href=/tags>標籤</a></li><li><a href=/comment>留言區</a></li><li><a href=/about>關於本人</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#什麼是數論>什麼是數論</a></li><li><a href=#模運算>模運算</a><ul><li><a href=#同餘>同餘</a><ul><li><a href=#證明>證明:</a></li></ul></li><li><a href=#加乘法性質>加乘法性質</a><ul><li><a href=#證明-1>證明:</a></li></ul></li><li><a href=#需要注意的地方>需要注意的地方</a></li></ul></li><li><a href=#快速幂取模>快速幂取模</a><ul><li><a href=#快速冪>快速冪</a><ul><li><a href=#遞迴版本>遞迴版本</a></li></ul></li></ul></li><li><a href=#最大公因數>最大公因數</a><ul><li><a href=#因數>因數</a></li><li><a href=#公因數與最大公因數gcd>公因數與最大公因數(GCD)</a></li><li><a href=#最大公因數性質>最大公因數性質</a></li><li><a href=#找到最大公因數>找到最大公因數</a></li><li><a href=#貝祖定理bezouts-thm>貝祖定理(Bezout&rsquo;s thm)</a></li></ul></li><li><a href=#質數>質數</a></li><li><a href=#中國剩餘定理>中國剩餘定理</a><ul><li><a href=#解法>解法</a></li><li><a href=#主定理>主定理</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=%2fposts%2f1%2falgo-number-theory%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=%2fposts%2f1%2falgo-number-theory%2f&text=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2f1%2falgo-number-theory%2f&is_video=false&description=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&body=Check out this article: %2fposts%2f1%2falgo-number-theory%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=%2fposts%2f1%2falgo-number-theory%2f&title=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=%2fposts%2f1%2falgo-number-theory%2f&name=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96&description=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98%e7%9b%ae%e9%8c%84%20%e4%bb%80%e9%ba%bc%e6%98%af%e6%95%b8%e8%ab%96%20%e6%95%b8%e5%ad%b8%e7%9a%84%e5%88%86%e6%94%af%ef%bc%8c%e5%b0%88%e9%96%80%e7%a0%94%e7%a9%b6%e6%95%b4%e6%95%b8%e7%9a%84%e6%80%a7%e8%b3%aa%e3%80%82%0a%e6%a8%a1%e9%81%8b%e7%ae%97%20%e5%90%8c%e9%a4%98%20%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%20%e8%a1%a8%e7%a4%ba%20%24n%5c%20%7c%5c%20%28a-b%29%24%20%28%20%24n%24%20%e6%95%b4%e9%99%a4%20%24a-b%24%20%29%ef%bc%8c%e7%a8%b1%20%24a%24%20%e8%88%87%20%24b%24%20%e6%a8%a1%20%24n%24%20%e5%90%8c%e9%a4%98%e3%80%82%0a%e6%af%94%e5%a6%82%0a7%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%0a10%20%e9%99%a4%e4%bb%a5%203%20%e9%a4%98%201%0a%e5%89%87%e5%8f%af%e4%bb%a5%e8%aa%aa%20%247%20%5cequiv%2010%20%5cpmod%203%24%0a%e8%ad%89%e6%98%8e%3a%20%e5%b0%8d%e6%96%bc%20%24a%20%5cequiv%20b%20%5cpmod%20k%20%24%0a%e4%bb%a4%20%24a%20%3d%20ks%20%2b%20r%2c%5c%20b%20%3d%20kt%20%2b%20r%24%0a%e5%85%a9%e5%bc%8f%e7%9b%b8%e6%b8%9b%e5%be%97%20%24a-b%20%3d%20k%28s-t%29%24%0a%e8%ad%89%e6%98%8e%e7%b5%90%e6%9d%9f%0a%e5%8a%a0%e4%b9%98%e6%b3%95%e6%80%a7%e8%b3%aa%20%e5%a6%82%e6%9e%9c%20%24a%20%5cequiv%20b%20%5cpmod%20n%20%24%2c%20%24c%20%5cequiv%20d%20%5cpmod%20n%20%24" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=%2fposts%2f1%2falgo-number-theory%2f&t=%e7%ae%97%e6%b3%95%e7%ad%86%e8%a8%98-%e6%95%b8%e8%ab%96" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 ErrorPro</div><div class=footer-right><nav><ul><li><a href=/>主頁</a></li><li><a href=/posts>廢文區</a></li><li><a href=/resources>資源</a></li><li><a href=/tags>標籤</a></li><li><a href=/comment>留言區</a></li><li><a href=/about>關於本人</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script type=text/javascript src=/js/nest.js count=150 color=4,238,81 opacity=0.5></script></html>